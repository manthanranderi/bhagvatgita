<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter Page - Bhagavad Gita</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<style>
    body {
        font-family: 'Roboto', sans-serif;
        margin: 0;
        padding: 0;
        background: #faf5f0;
        color: #333;
    }
    .container {
        display: flex;
        max-width: 1200px;
        margin: 20px auto;
        gap: 20px;
    }
    .main {
        flex: 2;
    }
    .sidebar {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 20px;
    }
    .breadcrumb {
        font-size: 14px;
        margin-bottom: 15px;
        color: #777;
    }
    .chapter-title {
        background: #f3ede6;
        padding: 20px;
        margin-bottom: 20px;
        border-radius: 8px;
    }
    .chapter-title h2 {
        margin: 0 0 5px 0;
    }
    .chapter-title p {
        margin: 0;
        font-style: italic;
        color: #555;
    }
    .chapter-discussion {
        background: #fff;
        padding: 20px;
        margin-bottom: 20px;
        border-radius: 8px;
        line-height: 1.6;
    }
    .verse {
        margin-bottom: 20px;
        background: #fff;
        padding: 15px;
        border-radius: 6px;
    }
    .verse-number {
        font-weight: 700;
        color: #c75b39;
        margin-bottom: 5px;
    }
    .verse-text {
        line-height: 1.6;
    }
    .verse-translation {
        font-style: italic;
        color: #555;
        margin-top: 5px;
    }
    .sidebar img {
        width: 100%;
        border-radius: 8px;
    }
    .chapter-nav, .verse-buttons {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
    }
    .chapter-nav button, .verse-buttons button {
        flex: 1;
        padding: 10px;
        border: none;
        background: #f3ede6;
        cursor: pointer;
        border-radius: 5px;
        font-weight: 500;
    }
    .chapter-nav button:hover, .verse-buttons button:hover {
        background: #e5d9cf;
    }
    .verse-buttons button {
        flex: 0 0 30%;
        margin-bottom: 5px;
    }
</style>
</head>
<body>
<div class="container">
    <div class="main">
        <div class="breadcrumb">
            Chapters &gt; Chapter 1
        </div>

        <div class="chapter-title">
            <h2>Chapter 1: Arjun visad Yog</h2>
            <p>Lamenting the Consequences of War â€¢ <span id="totalVerses">47</span> Verses</p>
        </div>

        <div id="chapterDiscussion" class="chapter-discussion">
            Loading discussion...
        </div>

        <div id="versesContainer">
            <!-- Verses will load here dynamically -->
        </div>
    </div>
    

    <div class="sidebar">
        <img src="./assets/imgs/bg_arjuna_lanscape_v2.webp" alt="Arjun Image">

        <div class="chapter-nav">
            <button disabled>&lt; Previous chapter</button>
            <button>Next chapter &gt;</button>
        </div>

        <div class="verse-buttons" id="verseButtons">
            <!-- Buttons will be generated dynamically -->
        </div>
    </div>
</div>


<script>

    // --- CONFIG ---
let chapterNumber = 1; // Default Chapter 1
let totalVerses = 47;  // Chapter 1 total verses

const versesContainer = document.getElementById('versesContainer');
const verseButtonsContainer = document.getElementById('verseButtons');
const chapterDiscussion = document.getElementById('chapterDiscussion');
const totalVersesElement = document.getElementById('totalVerses');

// Update total verses in UI
totalVersesElement.textContent = totalVerses;

// --- LOAD CHAPTER DISCUSSION ---
async function loadChapterDiscussion() {
    try {
        const response = await fetch('https://vedicscriptures.github.io/chapters');
        const data = await response.json();
        const chapter = data.find(c => c.chapter_number == chapterNumber);
        chapterDiscussion.textContent = chapter ? chapter.discussion || "Discussion not available." : "Discussion not available.";
    } catch (err) {
        chapterDiscussion.textContent = "Error loading discussion.";
        console.error(err);
    }
}

// --- LOAD A VERSE ---
async function loadVerse(verseNumber) {
    try {
        const response = await fetch(`https://vedicscriptures.github.io/slok/${chapterNumber}/${verseNumber}`);
        const data = await response.json();

        // Clear previous verses
        versesContainer.innerHTML = '';

        // Choose translation (Siva translation as example)
        let translationText = data.siva ? data.siva.et : (data.purohit ? data.purohit.et : "Translation not available.");

        // Create verse div
        const verseDiv = document.createElement('div');
        verseDiv.classList.add('verse');
        verseDiv.innerHTML = `
            <div class="verse-number">Verse ${data.verse}</div>
            <div class="verse-text">${data.slok}</div>
            <div class="verse-transliteration">${data.transliteration || ""}</div>
            <div class="verse-translation">${translationText}</div>
        `;
        versesContainer.appendChild(verseDiv);
    } catch (err) {
        versesContainer.innerHTML = "Error loading verse.";
        console.error(err);
    }
}

// --- GENERATE VERSE BUTTONS ---
function generateVerseButtons() {
    verseButtonsContainer.innerHTML = '';
    for (let i = 1; i <= totalVerses; i++) {
        const btn = document.createElement('button');
        btn.textContent = i;
        btn.addEventListener('click', () => loadVerse(i));
        verseButtonsContainer.appendChild(btn);
    }
}

// --- CHANGE CHAPTER ---
function changeChapter(newChapterNumber, newTotalVerses) {
    chapterNumber = newChapterNumber;
    totalVerses = newTotalVerses;
    totalVersesElement.textContent = totalVerses;

    loadVerse(1);
    loadChapterDiscussion();
    generateVerseButtons();
}

// --- INITIAL LOAD ---
loadChapterDiscussion();
generateVerseButtons();
loadVerse(1);

// --- NEXT / PREV CHAPTER BUTTONS ---
const prevBtn = document.querySelector('.chapter-nav button:first-child');
const nextBtn = document.querySelector('.chapter-nav button:last-child');

prevBtn.addEventListener('click', () => {
    if (chapterNumber > 1) {
        let newChapter = chapterNumber - 1;
        let newTotal = newChapter === 1 ? 47 : 72; // Update total verses per chapter
        changeChapter(newChapter, newTotal);
    }
});

nextBtn.addEventListener('click', () => {
    if (chapterNumber < 2) { // Only Chapter 1 and 2 for now
        let newChapter = chapterNumber + 1;
        let newTotal = newChapter === 1 ? 47 : 72; // Update total verses
        changeChapter(newChapter, newTotal);
    }
});


</script>
</body>
</html>
